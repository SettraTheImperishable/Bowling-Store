<!DOCTYPE html>
<html>
  <head>
    <title>BowlingStore</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <header>
      <nav>
        <ul>
          <li><%= link_to 'Home', root_path %></li>
          <li><%= link_to 'Categories', categories_path %></li>
          <li><%= link_to  'Products', products_path %></li>
          <li><%= link_to 'About', permalink_path(permalink: 'about_us') %></li>
          <li><%= link_to 'FAQ', permalink_path(permalink: 'faq') %></li>
        </ul>
      </nav>

      <%= form_with(url: search_results_products_path, method: "get", local: true) do %>
        <% categories_array = Category.all.map { |category| [category.name, category.id] } %>
        <% categories_array.insert(0, ['All', nil]) %>
        <%= label_tag(:query, "Search products for:") %>
        <%= text_field_tag(:query) %>
        <%= label_tag(:category_id, " from ") %>
        <%= select_tag(:category_id, options_for_select(categories_array)) %>
        <%= submit_tag("Search") %>
      <% end %>

      <details>
        <summary>Shopping Cart</summary>
        <% if @cart.empty? %>
          <p>No items in cart.</p>
        <% else %>
          <ul>
            <% @cart.each do |product| %>
              <li><%= product.name %> - <%= link_to 'remove from cart',  remove_from_cart_path(product), method: :delete %></li>
            <% end %>
          </ul>
        <% end %>
      </details>
    </header>
    <% if flash[:item_changed]  %>
      <p><%= flash[:item_changed] %></p>
    <% end %>

    <div class="content">
      <%= yield %>
    </div>
  </body>
</html>
